diff -up tigervnc-1.1.0/common/rfb/zrleDecode.h.CVE-2014-0011 tigervnc-1.1.0/common/rfb/zrleDecode.h
--- tigervnc-1.1.0/common/rfb/zrleDecode.h.CVE-2014-0011	2011-08-09 22:16:44.000000000 +0100
+++ tigervnc-1.1.0/common/rfb/zrleDecode.h	2014-02-05 12:30:28.636646075 +0000
@@ -25,9 +25,10 @@
 // FILL_RECT          - fill a rectangle with a single colour
 // IMAGE_RECT         - draw a rectangle of pixel data from a buffer
 
+#include <stdio.h>
 #include <rdr/InStream.h>
 #include <rdr/ZlibInStream.h>
-#include <assert.h>
+#include <rfb/Exception.h>
 
 namespace rfb {
 
@@ -143,7 +144,10 @@ void ZRLE_DECODE (const Rect& r, rdr::In
               len += b;
             } while (b == 255);
 
-            assert(len <= end - ptr);
+	    if (end - ptr < len) {
+	      fprintf (stderr, "ZRLE decode error\n");
+	      throw Exception ("ZRLE decode error");
+	    }
 
 #ifdef FAVOUR_FILL_RECT
             int i = ptr - buf;
@@ -193,7 +197,10 @@ void ZRLE_DECODE (const Rect& r, rdr::In
                 len += b;
               } while (b == 255);
 
-              assert(len <= end - ptr);
+	      if (end - ptr < len) {
+		fprintf (stderr, "ZRLE decode error\n");
+		throw Exception ("ZRLE decode error");
+	      }
             }
 
             index &= 127;
